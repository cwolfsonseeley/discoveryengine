---
output: 
    html_document:
      css: stylesheets/github-light.css
      self_contained: no
      theme: null
---
<div class="wrapper">
<header>
<a href="index.html"><h1>Discoveryengine</h1></a>
<p></p>
<p class="view"><a href="https://github.com/tarakc02/discoveryengine">View the Project on GitHub <small>tarakc02/discoveryengine</small></a></p>
<ul>
<li><a href="examples.html">Introductory <strong>Examples</strong></a></li>
<li><a href="developer-notes.html">Notes for <strong>Developers</strong></a></li>
<li><a href="https://github.com/tarakc02/discoveryengine">View On <strong>GitHub</strong></a></li>
</ul>
</header>
<section>
## Building a new discoveryengine widget
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(width = 63)
```
Today I'll be adding the `majored_in` widget to the discoveryengine. The steps that we'll go through are the same steps you'd take any time you were adding a new widget.

### Getting started
I've already cloned the discoveryengine repository and am working in a local directory. I start by loading existing code (if you're using RStudio, you can do this with Ctrl/Cmd + shift + L).

```{r}
devtools::load_all(".")
```

It's helpful as a first step to write a failing test. Tests serve as documentation for your widget, by specifying clearly the tables and fields that will be used by the widget. So I create a new file `tests/testthat/test-majored-in.R`:

```{r, eval = FALSE}
context("majored_in specifications")
source("helpers.R")
library(magrittr)

test_that("majored_in meets specifications on standard input", {
    test <- majored_in(540, 651)
    test %>% uses_table("d_bio_interest_mv")
    test %>% id_of_type("entity_id")
    test %>% id_field_is("entity_id")

    test %>%
        has_filters(interest_code = c("DAN", "ABC"))

    test %>% has_clause_count(1)

})

test_that("has_interest meets specifications on no input", {
    has_interest() %>%
        has_clause_count(0)
    has_interest() %>% uses_table("d_bio_interest_mv")
})

```

</section>
<footer><small>theme by @orderedlist</small></footer>
</div>
<script src="javascripts/scale.fix.js"></script>
